<!DOCTYPE html>
<html>
<head>
  <title>Student Bank Details - EMIS</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    const StudentBankDetails = () => {
      const [students, setStudents] = useState([]);
      const [filteredStudents, setFilteredStudents] = useState([]);
      const [loading, setLoading] = useState(true);
      const [selectedClass, setSelectedClass] = useState('');
      const [selectedSection, setSelectedSection] = useState('');
      const [searchKeyword, setSearchKeyword] = useState('');
      const [sortColumn, setSortColumn] = useState('');
      const [sortDirection, setSortDirection] = useState('asc');
      const [currentPage, setCurrentPage] = useState(1);
      const [itemsPerPage] = useState(10);

      useEffect(() => {
        setLoading(true);
        const mockData = [
          { id: 1, studentName: 'Rahul Kumar', studentEmisId: 'EMIS001234', class: '10', section: 'A', bankAccountAvailable: 'Yes', postalBankAccount: 'Yes' },
          { id: 2, studentName: 'Priya Sharma', studentEmisId: 'EMIS001235', class: '10', section: 'B', bankAccountAvailable: 'No', postalBankAccount: 'No' },
          { id: 3, studentName: 'Amit Singh', studentEmisId: 'EMIS001236', class: '11', section: 'A', bankAccountAvailable: 'Yes', postalBankAccount: 'Yes' },
          { id: 4, studentName: 'Sneha Patel', studentEmisId: 'EMIS001237', class: '11', section: 'B', bankAccountAvailable: 'Yes', postalBankAccount: 'No' },
          { id: 5, studentName: 'Vikram Reddy', studentEmisId: 'EMIS001238', class: '12', section: 'A', bankAccountAvailable: 'No', postalBankAccount: 'No' },
          { id: 6, studentName: 'Anita Desai', studentEmisId: 'EMIS001239', class: '12', section: 'B', bankAccountAvailable: 'Yes', postalBankAccount: 'Yes' },
          { id: 7, studentName: 'Rohan Gupta', studentEmisId: 'EMIS001240', class: '9', section: 'A', bankAccountAvailable: 'Yes', postalBankAccount: 'No' }
        ];
        setStudents(mockData);
        setFilteredStudents(mockData);
        setLoading(false);
      }, []);

      const classes = useMemo(() => {
        const uniqueClasses = [...new Set(students.map(s => s.class))];
        return uniqueClasses.sort((a, b) => parseInt(a) - parseInt(b));
      }, [students]);

      const sections = useMemo(() => {
        const uniqueSections = [...new Set(students.map(s => s.section))];
        return uniqueSections.sort();
      }, [students]);

      useEffect(() => {
        let filtered = [...students];
        if (selectedClass) filtered = filtered.filter(s => s.class === selectedClass);
        if (selectedSection) filtered = filtered.filter(s => s.section === selectedSection);
        if (searchKeyword) {
          const keyword = searchKeyword.toLowerCase();
          filtered = filtered.filter(s => 
            s.studentName.toLowerCase().includes(keyword) ||
            s.studentEmisId.toLowerCase().includes(keyword) ||
            s.class.includes(keyword) ||
            s.section.toLowerCase().includes(keyword) ||
            s.bankAccountAvailable.toLowerCase().includes(keyword) ||
            s.postalBankAccount.toLowerCase().includes(keyword)
          );
        }
        setFilteredStudents(filtered);
        setCurrentPage(1);
      }, [students, selectedClass, selectedSection, searchKeyword]);

      const handleSort = (column) => {
        const sortableColumns = ['studentName', 'studentEmisId', 'class', 'section'];
        if (!sortableColumns.includes(column)) return;
        
        let direction = 'asc';
        if (sortColumn === column && sortDirection === 'asc') direction = 'desc';
        
        const sorted = [...filteredStudents].sort((a, b) => {
          let aValue = a[column], bValue = b[column];
          if (column === 'class') {
            aValue = parseInt(aValue);
            bValue = parseInt(bValue);
          }
          if (aValue < bValue) return direction === 'asc' ? -1 : 1;
          if (aValue > bValue) return direction === 'asc' ? 1 : -1;
          return 0;
        });
        setFilteredStudents(sorted);
        setSortColumn(column);
        setSortDirection(direction);
      };

      const indexOfLastItem = currentPage * itemsPerPage;
      const indexOfFirstItem = indexOfLastItem - itemsPerPage;
      const currentItems = filteredStudents.slice(indexOfFirstItem, indexOfLastItem);
      const totalPages = Math.ceil(filteredStudents.length / itemsPerPage);

      const handleExcelDownload = () => {
        const headers = ['S.No', 'Student EMIS ID', 'Student Name', 'Class', 'Section', 'Bank Account Available', 'Postal Bank Account'];
        const csvContent = [
          headers.join(','),
          ...filteredStudents.map((student, index) => [
            index + 1, 
            student.studentEmisId, 
            `"${student.studentName}"`, 
            student.class, 
            student.section, 
            student.bankAccountAvailable, 
            student.postalBankAccount
          ].join(','))
        ].join('\n');
        const blob = new Blob([csvContent], { type: 'text/csv' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `Student_Postal_Bank_Details_${new Date().toISOString().split('T')[0]}.csv`;
        link.click();
      };

      const handleResetFilters = () => {
        setSelectedClass('');
        setSelectedSection('');
        setSearchKeyword('');
      };

      const styles = {
        container: { padding: '20px', backgroundColor: '#f5f5f5', minHeight: '100vh', fontFamily: 'Arial, sans-serif' },
        breadcrumb: { marginBottom: '20px', fontSize: '18px', color: '#333' },
        breadcrumbItem: { color: '#666' },
        breadcrumbSeparator: { margin: '0 8px', color: '#999' },
        breadcrumbItemActive: { color: '#333', fontWeight: '500' },
        contentCard: { background: 'white', borderRadius: '8px', boxShadow: '0 2px 10px rgba(0,0,0,0.1)', overflow: 'hidden', maxWidth: '1400px', margin: '0 auto' },
        filterSection: { padding: '20px', borderBottom: '1px solid #e0e0e0' },
        filterRow: { display: 'flex', justifyContent: 'space-between', alignItems: 'end', gap: '15px', flexWrap: 'wrap' },
        filterControls: { display: 'flex', gap: '15px', alignItems: 'end', flexWrap: 'wrap' },
        filterGroup: { display: 'flex', flexDirection: 'column', gap: '5px', minWidth: '160px' },
        label: { fontSize: '13px', fontWeight: '500', color: '#333' },
        filterDropdown: { padding: '8px 12px', border: '1px solid #ddd', borderRadius: '4px', fontSize: '14px' },
        resetBtn: { padding: '8px 16px', backgroundColor: '#f44336', color: 'white', border: 'none', borderRadius: '4px', cursor: 'pointer' },
        excelBtn: { padding: '8px 16px', backgroundColor: '#4CAF50', color: 'white', border: 'none', borderRadius: '4px', cursor: 'pointer', display: 'flex', alignItems: 'center', gap: '6px', fontWeight: '500' },
        searchGroup: { flex: 1, maxWidth: '300px' },
        searchInput: { width: '100%', padding: '8px 12px', border: '1px solid #ddd', borderRadius: '4px', fontSize: '14px' },
        tableContainer: { overflowX: 'auto' },
        table: { width: '100%', borderCollapse: 'collapse', fontSize: '14px' },
        th: { padding: '12px 15px', textAlign: 'left', fontWeight: '600', background: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)', color: 'white' },
        sortable: { cursor: 'pointer' },
        td: { padding: '12px 15px', borderBottom: '1px solid #eee' },
        statusYes: { padding: '4px 12px', borderRadius: '12px', fontSize: '12px', backgroundColor: '#d4edda', color: '#155724', fontWeight: '500' },
        statusNo: { padding: '4px 12px', borderRadius: '12px', fontSize: '12px', backgroundColor: '#f8d7da', color: '#721c24', fontWeight: '500' },
        pagination: { display: 'flex', justifyContent: 'center', alignItems: 'center', gap: '10px', padding: '20px', borderTop: '1px solid #e0e0e0' },
        pageBtn: { padding: '8px 12px', border: '1px solid #ddd', background: 'white', borderRadius: '4px', cursor: 'pointer' }
      };

      return (
        <div style={styles.container}>
          <div style={styles.breadcrumb}>
            <span style={styles.breadcrumbItem}>Students</span>
            <span style={styles.breadcrumbSeparator}>›</span>
            <span style={styles.breadcrumbItemActive}>Student Bank Details</span>
          </div>

          <div style={styles.contentCard}>
            <div style={styles.filterSection}>
              <div style={styles.filterRow}>
                <div style={styles.filterControls}>
                  <div style={styles.filterGroup}>
                    <label style={styles.label}>Class</label>
                    <select style={styles.filterDropdown} value={selectedClass} onChange={(e) => setSelectedClass(e.target.value)}>
                      <option value="">All Classes</option>
                      {classes.map(cls => <option key={cls} value={cls}>Class {cls}</option>)}
                    </select>
                  </div>
                  <div style={styles.filterGroup}>
                    <label style={styles.label}>Section</label>
                    <select style={styles.filterDropdown} value={selectedSection} onChange={(e) => setSelectedSection(e.target.value)}>
                      <option value="">All Sections</option>
                      {sections.map(sec => <option key={sec} value={sec}>{sec}</option>)}
                    </select>
                  </div>
                  {(selectedClass || selectedSection || searchKeyword) && (
                    <button style={styles.resetBtn} onClick={handleResetFilters}>Reset</button>
                  )}
                  <button style={styles.excelBtn} onClick={handleExcelDownload}>
                    ⬇ Excel Download
                  </button>
                </div>
                <div style={styles.searchGroup}>
                  <input style={styles.searchInput} placeholder="Search by name, EMIS ID..." value={searchKeyword} onChange={(e) => setSearchKeyword(e.target.value)} />
                </div>
              </div>
            </div>

            <div style={styles.tableContainer}>
              <table style={styles.table}>
                <thead>
                  <tr>
                    <th style={styles.th}>S.No</th>
                    <th style={{...styles.th, ...styles.sortable}} onClick={() => handleSort('studentEmisId')}>EMIS ID</th>
                    <th style={{...styles.th, ...styles.sortable}} onClick={() => handleSort('studentName')}>Student Name</th>
                    <th style={{...styles.th, ...styles.sortable}} onClick={() => handleSort('class')}>Class</th>
                    <th style={{...styles.th, ...styles.sortable}} onClick={() => handleSort('section')}>Section</th>
                    <th style={styles.th}>Bank Account</th>
                    <th style={styles.th}>Postal Bank Account</th>
                  </tr>
                </thead>
                <tbody>
                  {loading ? (
                    <tr><td colSpan="7" style={{textAlign: 'center', padding: '40px'}}>Loading...</td></tr>
                  ) : currentItems.length === 0 ? (
                    <tr><td colSpan="7" style={{textAlign: 'center', padding: '40px', color: '#666'}}>No Records Found</td></tr>
                  ) : (
                    currentItems.map((student, index) => (
                      <tr key={student.id}>
                        <td style={styles.td}>{indexOfFirstItem + index + 1}</td>
                        <td style={styles.td}>{student.studentEmisId}</td>
                        <td style={styles.td}>{student.studentName}</td>
                        <td style={styles.td}>{student.class}</td>
                        <td style={styles.td}>{student.section}</td>
                        <td style={styles.td}>
                          <span style={student.bankAccountAvailable === 'Yes' ? styles.statusYes : styles.statusNo}>
                            {student.bankAccountAvailable}
                          </span>
                        </td>
                        <td style={styles.td}>
                          <span style={student.postalBankAccount === 'Yes' ? styles.statusYes : styles.statusNo}>
                            {student.postalBankAccount}
                          </span>
                        </td>
                      </tr>
                    ))
                  )}
                </tbody>
              </table>
            </div>

            {filteredStudents.length > 0 && (
              <div style={styles.pagination}>
                <button style={styles.pageBtn} onClick={() => setCurrentPage(1)} disabled={currentPage === 1}>‹‹</button>
                <button style={styles.pageBtn} onClick={() => setCurrentPage(p => Math.max(p-1, 1))} disabled={currentPage === 1}>‹</button>
                <span>Page {currentPage} of {totalPages}</span>
                <button style={styles.pageBtn} onClick={() => setCurrentPage(p => Math.min(p+1, totalPages))} disabled={currentPage === totalPages}>›</button>
                <button style={styles.pageBtn} onClick={() => setCurrentPage(totalPages)} disabled={currentPage === totalPages}>››</button>
              </div>
            )}
          </div>
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<StudentBankDetails />);
  </script>
</body>
</html>
